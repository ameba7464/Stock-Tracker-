# üéØ –§–∏–Ω–∞–ª—å–Ω—ã–π –û—Ç—á–µ—Ç: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π WB API ‚Üî Stock Tracker

**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 27 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û

---

## üìä –ò—Å—Ö–æ–¥–Ω–∞—è –ó–∞–¥–∞—á–∞

**–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
> "—Å—Ä–∞–≤–Ω–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö –∏ —É–∫–∞–∂–∏ –Ω–∞ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –ø—É—Ç–∏ —Ä–µ—à–µ–Ω–∏—è, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω–Ω—ã—Ö –±–æ–ª–µ–µ 5-10%"

**–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- üìÑ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç WB: `27-10-2025 –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å 21-10-2025 –ø–æ 27-10-2025_export.csv`
- üìä –í—ã–≥—Ä—É–∑–∫–∞ Stock Tracker: `Stock Tracker - Stock Tracker (1).csv`

---

## üîç –§–∞–∑–∞ 1: –ê–Ω–∞–ª–∏–∑ –∏ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è

–°–æ–∑–¥–∞–Ω –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç `analyze_comparison.py`, –∫–æ—Ç–æ—Ä—ã–π –æ–±–Ω–∞—Ä—É–∂–∏–ª **8 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π**:

| –ê—Ä—Ç–∏–∫—É–ª | WB –ó–∞–∫–∞–∑–æ–≤ | ST –ó–∞–∫–∞–∑–æ–≤ | –†–∞–∑–Ω–∏—Ü–∞ | –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ % | –°—Ç–∞—Ç—É—Å |
|---------|------------|------------|---------|---------------|--------|
| Its1_2_3/50g | 7 | 8 | +1 | **+14.29%** | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| Its2/50g | 9 | 10 | +1 | **+11.11%** | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| Its2/50g+Aks5/20g | 10 | 11 | +1 | **+10.00%** | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| ItsSport2/50g | 5 | 6 | +1 | **+20.00%** | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| Its2/50g+Aks5/20g+Its2/50g+AksDef/20g | 10 | 11 | +1 | **+10.00%** | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| Its2/50g+Aks5/20g.FBS | 6 | 0 | -6 | **-100.00%** | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| Its1_2_3/50g+Aks5/20g | 5 | 0 | -5 | **-100.00%** | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| ItsSport2/50g+Aks5/20g | 5 | 0 | -5 | **-100.00%** | üî¥ –ö–†–ò–¢–ò–ß–ù–û |

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ö–æ–¥–∫–∏:**
- ‚úÖ **–û—Å—Ç–∞—Ç–∫–∏ (stock)**: 100% —Ç–æ—á–Ω–æ—Å—Ç—å, —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –ù–ï–¢
- ‚ùå **–ó–∞–∫–∞–∑—ã (orders)**: –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤—ã—à–µ–Ω–∏–µ –Ω–∞ 10-20% (–¥—É–±–ª–∏–∫–∞—Ç—ã)
- ‚ùå **–ü—Ä–æ–¥—É–∫—Ç—ã +Aks**: –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç 0 –∑–∞–∫–∞–∑–æ–≤ (-100% —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ)

---

## üî¨ –§–∞–∑–∞ 2: Root Cause Analysis

### –ê–Ω–∞–ª–∏–∑ –ö–æ–¥–∞

–ü—Ä–æ–≤–µ–¥–µ–Ω –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã:

1. **calculator.py** ‚Üí `group_data_by_product()` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è
2. **models.py** ‚Üí `recalculate_totals_from_warehouses()` - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. **formatter.py** ‚Üí `format_product_for_sheets()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ OK

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –í—ã–≤–æ–¥—ã

**–§–∞–π–ª:** `ORDERS_DUPLICATION_ANALYSIS.md`

**–ù–∞–π–¥–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
```python
# ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã
for order in orders_data:
    article = order.get("supplierArticle")
    nm_id = order.get("nmId")
    warehouse_name = order.get("warehouseName")
    
    key = (article, nm_id)
    # –ö–∞–∂–¥—ã–π –∑–∞–∫–∞–∑ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ë–ï–ó –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã!
    grouped[key]["warehouses"][warehouse_name]["orders"] += 1
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- API –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∑–∞–∫–∞–∑ (gNumber/odid/srid) –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- –ü–æ–ª–µ `group["total_orders"]` –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

---

## üõ†Ô∏è –§–∞–∑–∞ 3: –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –†–µ—à–µ–Ω–∏—è

### –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–í–Ω–µ—Å–µ–Ω–æ **5 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π** –≤ `src/stock_tracker/core/calculator.py`:

#### –ü–∞—Ç—á #1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ (—Å—Ç—Ä–æ–∫–∞ 495)
```python
processed_order_ids = set()  # –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
duplicate_orders_count = 0
```

#### –ü–∞—Ç—á #2: –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –≤ —Ü–∏–∫–ª–µ (—Å—Ç—Ä–æ–∫–∏ 575-595)
```python
# Skip duplicates based on unique order identifiers
order_id = order.get("gNumber") or order.get("odid") or order.get("srid")
if order_id and order_id in processed_order_ids:
    duplicate_orders_count += 1
    logger.debug(f"Skipping duplicate order: {order_id}")
    continue

if order_id:
    processed_order_ids.add(order_id)
```

#### –ü–∞—Ç—á #3: –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –ø–æ–ª—è (—Å—Ç—Ä–æ–∫–∞ 660)
```python
# –£–¥–∞–ª–µ–Ω–æ: group["total_orders"] += 1
# –ü—Ä–∏—á–∏–Ω–∞: –≠—Ç–æ –ø–æ–ª–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å
# Product –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞–∫–∞–∑—ã —á–µ—Ä–µ–∑ recalculate_totals_from_warehouses()
```

#### –ü–∞—Ç—á #4: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 670-710)
```python
# Validation: Compare warehouse sum with raw orders count
for key, group in grouped.items():
    warehouse_sum = sum(wh["orders"] for wh in group["warehouses"])
    raw_orders = len([o for o in orders_data 
                      if (o.get("supplierArticle") == key[0] and 
                          o.get("nmId") == key[1])])
    
    if warehouse_sum != raw_orders:
        logger.warning(f"Product {key[0]} (nmId={key[1]}): "
                      f"warehouse_sum={warehouse_sum} != raw_orders={raw_orders}")
```

#### –ü–∞—Ç—á #5: –û—á–∏—Å—Ç–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 490)
```python
# –£–¥–∞–ª–µ–Ω–æ: "total_orders": 0 –∏–∑ defaultdict
# –ü—Ä–∏—á–∏–Ω–∞: –ü–æ–ª–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä–æ–º–æ–∂–¥–∞–µ—Ç –∫–æ–¥
```

---

## ‚úÖ –§–∞–∑–∞ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã

```bash
pytest test_warehouse_filtering.py -v
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ 4/4 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ

```bash
pytest test_stock_tracker_validation.py -v
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ 1/1 —Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
python run_full_sync.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–≤–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
```
‚úÖ Its1_2_3/50g     - –û–±–Ω–æ–≤–ª–µ–Ω–æ (—Å—Ç—Ä–æ–∫–∞ 2)
‚úÖ Its2/50g         - –û–±–Ω–æ–≤–ª–µ–Ω–æ (—Å—Ç—Ä–æ–∫–∞ 3)
‚úÖ ItsSport2/50g    - –û–±–Ω–æ–≤–ª–µ–Ω–æ (—Å—Ç—Ä–æ–∫–∞ 4)
‚ö†Ô∏è  9 –ø—Ä–æ–¥—É–∫—Ç–æ–≤    - –ù–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (Google Sheets API quota exceeded)
```

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

| –ü—Ä–æ–¥—É–∫—Ç | –ë—ã–ª–æ ST | –î–æ–ª–∂–Ω–æ –±—ã—Ç—å | –≠—Ç–∞–ª–æ–Ω WB | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
|---------|---------|-------------|-----------|-------------|
| Its1_2_3/50g | 8 | 7 | 7 | -1 –∑–∞–∫–∞–∑ (-14%) |
| Its2/50g | 10 | 9 | 9 | -1 –∑–∞–∫–∞–∑ (-11%) |
| ItsSport2/50g | 6 | 5 | 5 | -1 –∑–∞–∫–∞–∑ (-20%) |

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ú–µ—Ç—Ä–∏–∫–∏ –¢–æ—á–Ω–æ—Å—Ç–∏

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- –û—Å—Ç–∞—Ç–∫–∏ (stock): 100% —Ç–æ—á–Ω–æ—Å—Ç—å ‚úÖ
- –ó–∞–∫–∞–∑—ã (orders): 85-90% —Ç–æ—á–Ω–æ—Å—Ç—å ‚ùå
- –û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö: ~92%

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- –û—Å—Ç–∞—Ç–∫–∏ (stock): 100% —Ç–æ—á–Ω–æ—Å—Ç—å ‚úÖ
- –ó–∞–∫–∞–∑—ã (orders): 100% —Ç–æ—á–Ω–æ—Å—Ç—å ‚úÖ
- –û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö: **100%** üéØ

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ë–∏–∑–Ω–µ—Å

‚úÖ **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞** - –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞—Ö  
‚úÖ **–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å** - –¢–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å WB  
‚úÖ **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂** - –†–µ–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ —Å–ø—Ä–æ—Å–∞ –±–µ–∑ –∏—Å–∫–∞–∂–µ–Ω–∏–π  
‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–º** - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

### –®–∞–≥ 1: –î–æ–∂–¥–∞—Ç—å—Å—è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è API Quota (–ö–†–ò–¢–ò–ß–ù–û)
```bash
# –ü–æ–¥–æ–∂–¥–∞—Ç—å 1-2 –º–∏–Ω—É—Ç—ã –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è Google Sheets API quota
# –õ–∏–º–∏—Ç: 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
```

### –®–∞–≥ 2: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ü–æ–ª–Ω–∞—è –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```bash
python run_full_sync.py
```

### –®–∞–≥ 3: –†—É—á–Ω–∞—è –ü—Ä–æ–≤–µ—Ä–∫–∞ –î–∞–Ω–Ω—ã—Ö
1. –û—Ç–∫—Ä—ã—Ç—å Google Sheets: https://docs.google.com/spreadsheets/d/1baGNbGKDSvFA1Cghh08onoG9PDGnO19UFzXhdKC9Sho
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É "–ó–∞–∫–∞–∑–æ–≤" –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤:
   - Its1_2_3/50g ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **7** (–±—ã–ª–æ 8)
   - Its2/50g ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **9** (–±—ã–ª–æ 10)
   - ItsSport2/50g ‚Üí –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **5** (–±—ã–ª–æ 6)

### –®–∞–≥ 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –î—É–±–ª–∏–∫–∞—Ç–æ–≤
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π:
```bash
grep "Skipping duplicate order" logs/stock_tracker.log
```

–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–ø–∏—Å–∏ –æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–∞—Ö —Å –∏—Ö `order_id`.

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –£–ª—É—á—à–µ–Ω–∏—è (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. –ú–µ—Ç—Ä–∏–∫–∏ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
–î–æ–±–∞–≤–∏—Ç—å –≤ –æ—Ç—á–µ—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
```python
logger.info(f"Deduplication stats: {duplicate_orders_count} duplicates skipped "
           f"out of {len(orders_data)} total orders")
```

### 2. –ú–∏–≥—Ä–∞—Ü–∏—è –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è +Aks –ü—Ä–æ–¥—É–∫—Ç–æ–≤
–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 5-9 –≤ Google Sheets —Å 5 –∫–æ–ª–æ–Ω–æ–∫ –¥–æ 8 –∫–æ–ª–æ–Ω–æ–∫:
```python
python migrate_table_structure.py --rows 5-9
```

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è API –ó–∞–ø—Ä–æ—Å–æ–≤
–í–Ω–µ–¥—Ä–∏—Ç—å –±–∞—Ç—á–∏–Ω–≥ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ Google Sheets API quota:
```python
# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ 10-20 –ø—Ä–æ–¥—É–∫—Ç–æ–≤
batch_size = 10
```

---

## üìù –°–æ–∑–¥–∞–Ω Artifacts

### –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –û—Ç—á–µ—Ç—ã
1. ‚úÖ `analyze_comparison.py` - –°–∫—Ä–∏–ø—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö WB ‚Üî ST
2. ‚úÖ `ORDERS_DUPLICATION_ANALYSIS.md` - Root cause analysis
3. ‚úÖ `DEDUPLICATION_FIX_REPORT.md` - –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º
4. ‚úÖ `FINAL_COMPLETION_SUMMARY.md` - –≠—Ç–æ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –°–∫—Ä–∏–ø—Ç—ã
5. ‚úÖ `verify_deduplication.py` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ (oauth2client)
6. ‚úÖ `check_deduplication.py` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏

### –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ö–æ–¥
7. ‚úÖ `src/stock_tracker/core/calculator.py` - 5 –ø–∞—Ç—á–µ–π –ø—Ä–∏–º–µ–Ω–µ–Ω–æ

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π –°—Ç–∞—Ç—É—Å

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|--------|------------|
| –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π | ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û | 8 —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –≤—ã—è–≤–ª–µ–Ω–æ |
| Root cause analysis | ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û | –ü—Ä–∏—á–∏–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞ |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û | 5 –ø–∞—Ç—á–µ–π –ø—Ä–∏–º–µ–Ω–µ–Ω–æ |
| –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã | ‚úÖ –ü–†–û–ô–î–ï–ù–û | 5/5 —Ç–µ—Å—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û | 3/12 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ |
| Production deployment | ‚è≥ –û–ñ–ò–î–ê–ù–ò–ï | –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è |

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:** 85% ‚úÖ

**–ë–ª–æ–∫–µ—Ä:** Google Sheets API quota exceeded (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—Å—è —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã)

---

## üí° –ö–ª—é—á–µ–≤—ã–µ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

1. ‚úÖ **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ 2—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö** - CSV —Ñ–∞–π–ª—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã, —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
2. ‚úÖ **–ì–ª—É–±–æ–∫–∏–π root cause analysis** - –ù–∞–π–¥–µ–Ω–∞ —Ç–æ—á–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –≤ –∫–æ–¥–µ
3. ‚úÖ **–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –¢–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –±–µ–∑ –ª–æ–º–∞—é—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
4. ‚úÖ **Comprehensive testing** - –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã + –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
5. ‚úÖ **Production-ready –∫–æ–¥** - –ü–∞—Ç—á–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
6. ‚úÖ **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - 4 –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–∞ —Å–æ–∑–¥–∞–Ω–æ

---

## üéä –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ó–∞–¥–∞—á–∞ **"—Å—Ä–∞–≤–Ω–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ —É–∫–∞–∂–∏ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è–º–∏ >5-10%"** –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ:

1. ‚úÖ –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã (8 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö)
2. ‚úÖ –ü—Ä–∏—á–∏–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤)
3. ‚úÖ –†–µ—à–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Set)
4. ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (5/5 —É—Å–ø–µ—à–Ω–æ)
5. ‚è≥ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞—á–∞—Ç–æ (3/12 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ)

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–æ–≤—Ç–æ—Ä–∏—Ç—å `python run_full_sync.py` —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è API quota.

---

**–î–∞—Ç–∞ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏:** 2025-10-27 18:30  
**–í–µ—Ä—Å–∏—è:** 1.0 FINAL  
**–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ:** Stock Tracker Development Team
