# Stock Tracker Telegram Bot - ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¸ Ğ¡Ñ…ĞµĞ¼Ğ° Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ

## Ğ”Ğ»Ñ AI-Ğ°ÑÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ¾Ğ²: ĞšÑ€Ğ°Ñ‚ĞºĞ¾Ğµ Ñ€ĞµĞ·ÑĞ¼Ğµ

Ğ­Ñ‚Ğ¾ **Telegram-Ğ±Ğ¾Ñ‚ Ğ´Ğ»Ñ ÑĞµĞ»Ğ»ĞµÑ€Ğ¾Ğ² Wildberries**, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹:
1. Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ (Ğ¸Ğ¼Ñ â†’ email â†’ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½)
2. ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ API-ĞºĞ»ÑÑ‡ Wildberries Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
3. Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½ÑƒÑ Google Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ¾ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ°Ñ…
4. ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ² 00:01 ĞœĞ¡Ğš

---

## 1. ĞĞ±Ñ‰Ğ°Ñ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TELEGRAM BOT                            â”‚
â”‚                    (aiogram 3.x + FSM)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Handlers    â”‚  â”‚   Services    â”‚  â”‚   Database    â”‚       â”‚
â”‚  â”‚  (Routers)    â”‚  â”‚               â”‚  â”‚  (SQLAlchemy) â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚          â”‚                  â”‚                  â”‚                â”‚
â”‚          â–¼                  â–¼                  â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ start.py      â”‚  â”‚ wb_integrationâ”‚  â”‚ models.py     â”‚       â”‚
â”‚  â”‚ registration  â”‚  â”‚ google_sheets â”‚  â”‚ crud.py       â”‚       â”‚
â”‚  â”‚ menu.py       â”‚  â”‚ scheduler.py  â”‚  â”‚ database.py   â”‚       â”‚
â”‚  â”‚ api_key.py    â”‚  â”‚ validation.py â”‚  â”‚               â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ’ĞĞ•Ğ¨ĞĞ˜Ğ• Ğ¡Ğ•Ğ Ğ’Ğ˜Ğ¡Ğ«                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Wildberries API    â”‚           Google APIs                    â”‚
â”‚  (Analytics/Stats)   â”‚   (Sheets API + Drive API)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞŸÑ€Ğ¾ĞµĞºÑ‚Ğ°

```
telegram-bot/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°, Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±Ğ¾Ñ‚Ğ°
â”‚   â”œâ”€â”€ config.py            # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· .env (pydantic-settings)
â”‚   â”‚
â”‚   â”œâ”€â”€ bot/
â”‚   â”‚   â”œâ”€â”€ handlers/        # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ (Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ñ‹)
â”‚   â”‚   â”‚   â”œâ”€â”€ start.py     # /start, /help
â”‚   â”‚   â”‚   â”œâ”€â”€ registration.py  # Ğ’Ğ¾Ñ€Ğ¾Ğ½ĞºĞ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ menu.py      # Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ (about, help)
â”‚   â”‚   â”‚   â””â”€â”€ api_key.py   # Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ WB API ĞºĞ»ÑÑ‡Ğ¾Ğ¼
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ keyboards/       # ĞšĞ»Ğ°Ğ²Ğ¸Ğ°Ñ‚ÑƒÑ€Ñ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ inline.py    # InlineKeyboard (Ğ¼ĞµĞ½Ñ)
â”‚   â”‚   â”‚   â””â”€â”€ reply.py     # ReplyKeyboard (Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ middlewares/     # Middleware
â”‚   â”‚   â”‚   â”œâ”€â”€ db.py        # Ğ˜Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ ÑĞµÑÑĞ¸Ğ¸ Ğ‘Ğ”
â”‚   â”‚   â”‚   â””â”€â”€ payment.py   # Ğ—Ğ°Ğ³Ğ»ÑƒÑˆĞºĞ° Ğ´Ğ»Ñ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ states.py        # FSM States (Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ, API ĞºĞ»ÑÑ‡)
â”‚   â”‚
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ models.py        # SQLAlchemy Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ (User)
â”‚   â”‚   â”œâ”€â”€ crud.py          # CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
â”‚   â”‚   â””â”€â”€ database.py      # ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ‘Ğ”
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ wb_integration.py    # Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ WB API
â”‚   â”‚   â”œâ”€â”€ google_sheets.py     # Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Google Sheets
â”‚   â”‚   â”œâ”€â”€ scheduler.py         # ĞĞ²Ñ‚Ğ¾Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ (APScheduler)
â”‚   â”‚   â””â”€â”€ validation.py        # Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
â”‚   â”‚
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logger.py        # Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
â”‚
â”œâ”€â”€ credentials.json         # Google Service Account
â”œâ”€â”€ token.json               # Google OAuth Ñ‚Ğ¾ĞºĞµĞ½
â”œâ”€â”€ .env                     # ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
â””â”€â”€ requirements.txt         # Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
```

---

## 3. ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ…

### 3.1 User (Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `users`)

```python
class User:
    id: int                    # PK, autoincrement
    telegram_id: int           # Unique, Ğ¸Ğ½Ğ´ĞµĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½
    name: str                  # Ğ˜Ğ¼Ñ (Ğ´Ğ¾ 100 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²)
    email: str                 # Email (Ğ´Ğ¾ 255 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²)
    phone: str                 # Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½ (Ğ´Ğ¾ 20 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²)
    wb_api_key: str | None     # API ĞºĞ»ÑÑ‡ WB (Ğ´Ğ¾ 500 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²)
    google_sheet_id: str | None # ID ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Google Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
    payment_status: str        # 'pending' | 'completed' | 'failed'
    google_sheet_sent: bool    # Ğ¤Ğ»Ğ°Ğ³ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
    created_at: datetime       # Ğ’Ñ€ĞµĞ¼Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ
    updated_at: datetime       # Ğ’Ñ€ĞµĞ¼Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ
```

---

## 4. FSM States (ĞšĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğ¹ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚)

### 4.1 RegistrationStates
```
START â†’ GET_NAME â†’ GET_EMAIL â†’ GET_PHONE â†’ REGISTERED
```

| State | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğ¹ Ğ²Ğ²Ğ¾Ğ´ |
|-------|----------|----------------|
| `GET_NAME` | ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ¼ĞµĞ½Ğ¸ | Ğ¢ĞµĞºÑÑ‚ 2-50 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ² |
| `GET_EMAIL` | ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ email | Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹ email |
| `GET_PHONE` | ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ° | ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚ Ğ¸Ğ»Ğ¸ 10-15 Ñ†Ğ¸Ñ„Ñ€ |

### 4.2 ApiKeyStates
```
MENU â†’ WAITING_FOR_API_KEY â†’ (validate) â†’ MENU
```

| State | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğ¹ Ğ²Ğ²Ğ¾Ğ´ |
|-------|----------|----------------|
| `WAITING_FOR_API_KEY` | ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ WB API ĞºĞ»ÑÑ‡Ğ° | Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ° >50 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ² |

---

## 5. Ğ¡Ñ…ĞµĞ¼Ğ° Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ (User Journey)

### 5.1 ĞĞ¾Ğ²Ñ‹Ğ¹ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ¬                                    Ğ‘ĞĞ¢              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  /start â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ĞŸÑ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ + Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¸Ğ¼ĞµĞ½Ğ¸                 â”‚
â”‚                      [FSM: GET_NAME]                             â”‚
â”‚                                                                  â”‚
â”‚  "Ğ˜Ğ²Ğ°Ğ½" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ email                               â”‚
â”‚                      [FSM: GET_EMAIL]                            â”‚
â”‚                                                                  â”‚
â”‚  "ivan@mail.ru" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°                            â”‚
â”‚                      [FSM: GET_PHONE]                            â”‚
â”‚                      [ĞšĞ½Ğ¾Ğ¿ĞºĞ° "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ¼ĞµÑ€"]                  â”‚
â”‚                                                                  â”‚
â”‚  [ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚] Ğ¸Ğ»Ğ¸ "+79991234567" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
â”‚                                                                  â”‚
â”‚                      [DB: CREATE User]                           â”‚
â”‚                      [payment_status='completed']                â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ğ£ÑĞ¿ĞµÑ… Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸                          â”‚
â”‚                      [Ğ“Ğ›ĞĞ’ĞĞĞ• ĞœĞ•ĞĞ® Ğ±ĞµĞ· API ĞºĞ»ÑÑ‡Ğ°]                â”‚
â”‚                                                                  â”‚
â”‚  [ğŸš€ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ API ĞºĞ»ÑÑ‡] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ»ÑÑ‡Ğ°                 â”‚
â”‚                      [FSM: WAITING_FOR_API_KEY]                  â”‚
â”‚                                                                  â”‚
â”‚  "eyJhbGciOiJIUz..." â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
â”‚                                                                  â”‚
â”‚                      [WB API: validate_api_key]                  â”‚
â”‚                      [DB: UPDATE wb_api_key]                     â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ API ĞºĞ»ÑÑ‡ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½                          â”‚
â”‚                      [Ğ“Ğ›ĞĞ’ĞĞĞ• ĞœĞ•ĞĞ® Ñ API ĞºĞ»ÑÑ‡Ğ¾Ğ¼]                 â”‚
â”‚                                                                  â”‚
â”‚  [ğŸ“Š ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
â”‚                                                                  â”‚
â”‚                      [WB API: fetch data]                        â”‚
â”‚                      [Google Sheets: create/update]              â”‚
â”‚                      [DB: UPDATE google_sheet_id]                â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ğ¡ÑÑ‹Ğ»ĞºĞ° Ğ½Ğ° Google Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ                   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ÑÑ‰Ğ¸Ğ¹ÑÑ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ¬                                    Ğ‘ĞĞ¢              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  /start â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
â”‚                                                                  â”‚
â”‚                      [DB: get_user_by_telegram_id]               â”‚
â”‚                      [ĞĞ°Ğ¹Ğ´ĞµĞ½, payment_status='completed']        â”‚
â”‚                                                                  â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ "Ğ¡ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸ĞµĞ¼, {name}!"                  â”‚
â”‚                      [Ğ“Ğ›ĞĞ’ĞĞĞ• ĞœĞ•ĞĞ®]                              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Callback Query Handlers

### 6.1 Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ ĞœĞµĞ½Ñ

| callback_data | Handler | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ |
|---------------|---------|----------|
| `add_api_key` | `api_key.py` | ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ² FSM WAITING_FOR_API_KEY |
| `update_api_key` | `api_key.py` | Ğ¢Ğ¾ Ğ¶Ğµ (Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ) |
| `generate_table` | `api_key.py` | Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ/Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ |
| `about` | `menu.py` | Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞµ |
| `help` | `menu.py` | Ğ¡Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¸ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ñ‹ |

### 6.2 Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° ĞšĞ½Ğ¾Ğ¿Ğ¾Ğº ĞœĞµĞ½Ñ

```python
def get_main_menu_keyboard(has_api_key: bool):
    if has_api_key:
        # [ğŸ“Š ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ Stock Tracker]
        # [ğŸ”‘ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ API ĞºĞ»ÑÑ‡]
    else:
        # [ğŸš€ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ API ĞºĞ»ÑÑ‡ Wildberries]
    
    # [â„¹ï¸ Ğ ÑĞµÑ€Ğ²Ğ¸ÑĞµ]
    # [ğŸ’¬ ĞŸĞ¾Ğ¼Ğ¾Ñ‰ÑŒ]
```

---

## 7. Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

### 7.1 Wildberries API

**Ğ¤Ğ°Ğ¹Ğ»:** `services/wb_integration.py`

```python
class WBIntegrationService:
    async def validate_api_key(api_key: str) -> bool
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ ĞºĞ»ÑÑ‡ Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğº WB API
        # Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ WildberriesDataCollector Ğ¸Ğ· ĞºĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
    
    async def generate_or_get_table(user, session) -> Optional[str]
        # 1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ· WB (_fetch_wb_data)
        # 2. Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ¸Ğ»Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Google Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ
        # 3. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ URL Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
```

**Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ:** `wildberries_complete_data_collector.py` (Ğ² ĞºĞ¾Ñ€Ğ½Ğµ `Stock Tracker`)

### 7.2 Google Sheets API

**Ğ¤Ğ°Ğ¹Ğ»:** `services/google_sheets.py`

**ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ:**
- **Service Account** (`credentials.json`) â€” Ğ´Ğ»Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†
- **OAuth 2.0** (`token.json`) â€” Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† (Ğ¾Ñ‚ Ğ¸Ğ¼ĞµĞ½Ğ¸ Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†Ğ°)

```python
class GoogleSheetsService:
    async def create_sheet(user_name, telegram_id, data) -> Optional[str]
        # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ Ñ‡ĞµÑ€ĞµĞ· OAuth
        # Ğ”Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ° Service Account Ğ¸ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿
        # Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ sheet_id
    
    async def update_sheet(sheet_id, data) -> bool
        # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ¹ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğµ
```

### 7.3 ĞĞ²Ñ‚Ğ¾Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ (Scheduler)

**Ğ¤Ğ°Ğ¹Ğ»:** `services/scheduler.py`

```python
class AutoUpdateScheduler:
    # APScheduler (AsyncIOScheduler)
    # Ğ—Ğ°Ğ¿ÑƒÑĞº: 00:01 ĞœĞ¡Ğš ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ
    
    async def update_all_user_tables():
        # Ğ’Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ñ wb_api_key + google_sheet_id
        # Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾: fetch WB data â†’ update Google Sheet
```

---

## 8. Middleware

### 8.1 DatabaseMiddleware
```python
# Ğ˜Ğ½Ğ¶ĞµĞºÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ AsyncSession Ğ² data['session'] Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ°
async with async_session_maker() as session:
    data['session'] = session
    return await handler(event, data)
```

### 8.2 PaymentMiddleware
```python
# Ğ—ĞĞ“Ğ›Ğ£Ğ¨ĞšĞ Ğ´Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¹ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
# Ğ¡ĞµĞ¹Ñ‡Ğ°Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ğ²ÑĞµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
```

---

## 9. ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (.env)

```env
# Telegram
BOT_TOKEN=...

# Database (PostgreSQL / SQLite)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=tgstock
DB_USER=postgres
DB_PASSWORD=...

# Google
GOOGLE_SHEET_URL=https://docs.google.com/spreadsheets/d/...
GOOGLE_DRIVE_FOLDER_ID=...  # ĞŸĞ°Ğ¿ĞºĞ° Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†

# Admin
ADMIN_IDS=123456789,987654321

# Payments (Ğ·Ğ°Ğ³Ğ»ÑƒÑˆĞºĞ°)
PAYMENT_ENABLED=false
PAYMENT_PROVIDER=yookassa
PAYMENT_TOKEN=
```

---

## 10. Ğ¢Ğ¾Ñ‡ĞºĞ¸ Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ (TODO)

### 10.1 Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ ĞŸĞ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹
```python
# Ğ’ registration.py:
# if settings.payment_enabled:
#     await send_payment_invoice(message, user)
#     await state.set_state(RegistrationStates.PAYMENT_PENDING)

# Ğ’ payment.py middleware:
# if settings.payment_enabled:
#     if not await check_payment_status(user_id):
#         block_access()
```

### 10.2 GoogleSheetStates
```python
# Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚, Ğ½Ğ¾ Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ
class GoogleSheetStates(StatesGroup):
    WAITING_FOR_SHEET_ID = State()  # Ğ”Ğ»Ñ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ° ID Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
```

---

## 11. Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° ĞŸĞ¾Ñ‚Ğ¾ĞºĞ° Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Telegram â”‚â”€â”€â”€â”€â–ºâ”‚   Handler   â”‚â”€â”€â”€â”€â–ºâ”‚   Service    â”‚â”€â”€â”€â”€â–ºâ”‚  Database   â”‚
â”‚  User   â”‚     â”‚  (Router)   â”‚     â”‚              â”‚     â”‚(PostgreSQL) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚                                         â”‚
                      â–¼                                         â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚Wildberries  â”‚                          â”‚Google Sheetsâ”‚
               â”‚    API      â”‚                          â”‚     API     â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 12. Ğ ĞµĞ·ÑĞ¼Ğµ Ğ´Ğ»Ñ AI-Ğ°ÑÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ°

**ĞŸÑ€Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ Ñ ÑÑ‚Ğ¸Ğ¼ Ğ±Ğ¾Ñ‚Ğ¾Ğ¼ ÑƒÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°Ğ¹:**

1. **Framework:** aiogram 3.x Ñ FSM (MemoryStorage)
2. **ORM:** SQLAlchemy 2.0 (async)
3. **Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:** PostgreSQL (prod) / SQLite (dev)
4. **Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğµ API:** Wildberries (Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°), Google Sheets + Drive
5. **ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº:** APScheduler (ĞµĞ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ)

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸:**
- ĞĞ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ â†’ `app/bot/handlers/`
- ĞĞ¾Ğ²Ñ‹Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ FSM â†’ `app/bot/states.py`
- ĞĞ¾Ğ²Ñ‹Ğµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ â†’ `app/bot/keyboards/inline.py`
- ĞĞ¾Ğ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ â†’ `app/database/models.py` + Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Alembic
- Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° â†’ `app/services/`

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ:**
- ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ¸ â€” Ğ·Ğ°Ğ³Ğ»ÑƒÑˆĞºĞ° (`payment_enabled=false`)
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ OAuth Ñ‚Ğ¾ĞºĞµĞ½ (`get_oauth_token.py`)
- Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ WB Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ÑÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ `WildberriesDataCollector`
