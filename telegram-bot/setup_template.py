"""
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë              –†–ï–®–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã                    ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üéØ –ù–û–í–´–ô –ü–û–î–•–û–î:
   Service Account –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–π–ª—ã –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.
   –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –±—É–¥–µ–º –ö–û–ü–ò–†–û–í–ê–¢–¨ —à–∞–±–ª–æ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É.

üìã –ò–ù–°–¢–†–£–ö–¶–ò–Ø:

1Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ —à–∞–±–ª–æ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –≤—Ä—É—á–Ω—É—é:
   - –û—Ç–∫—Ä–æ–π—Ç–µ https://sheets.google.com
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É
   - –ù–∞–∑–æ–≤–∏—Ç–µ –µ—ë "Stock Tracker - Template"
   - –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç–æ–π –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏

2Ô∏è‚É£ –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —à–∞–±–ª–æ–Ω –≤ –ø–∞–ø–∫—É Stock Tracker Sheets:
   - –≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —à–∞–±–ª–æ–Ω
   - –ë–æ—Ç –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –µ—ë –∫–æ–ø–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

3Ô∏è‚É£ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –¥–æ—Å—Ç—É–ø Service Account –∫ —à–∞–±–ª–æ–Ω—É:
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É
   - –ù–∞–∂–º–∏—Ç–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞"
   - –î–æ–±–∞–≤—å—Ç–µ: stocktr@stocktr-479319.iam.gserviceaccount.com
   - –†–æ–ª—å: "–ß–∏—Ç–∞—Ç–µ–ª—å" (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è)

4Ô∏è‚É£ –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã-—à–∞–±–ª–æ–Ω–∞:
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –∏–∑ URL (—á–∞—Å—Ç—å –º–µ–∂–¥—É /d/ –∏ /edit)
   - –ü—Ä–∏–º–µ—Ä: https://docs.google.com/spreadsheets/d/1ABC...XYZ/edit
   - ID: 1ABC...XYZ

5Ô∏è‚É£ –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ø–∏–π:
   - –ö–æ–ø–∏–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –≤ –ø–∞–ø–∫–µ: 1NkBvCFyFpXRg8Opno6-_Cf8mTeT7OHRA
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Service Account –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ "–†–µ–¥–∞–∫—Ç–æ—Ä" –Ω–∞ —ç—Ç—É –ø–∞–ø–∫—É

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üí° –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢:
   1. –ë–æ—Ç –±–µ—Ä—ë—Ç —à–∞–±–ª–æ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
   2. –°–æ–∑–¥–∞—ë—Ç –µ—ë –∫–æ–ø–∏—é —á–µ—Ä–µ–∑ Drive API
   3. –ö–æ–ø–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ (–≤ –í–ê–®–ï–ú Drive)
   4. –ö–æ–ø–∏—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –í–ê–ú, –∞ –Ω–µ Service Account
   5. –ó–∞–ø–æ–ª–Ω—è–µ—Ç –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:
   ‚Ä¢ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è Service Account
   ‚Ä¢ –í—Å–µ —Ñ–∞–π–ª—ã –≤ –≤–∞—à–µ–º Drive
   ‚Ä¢ –õ–µ–≥–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø–æ–º
   ‚Ä¢ –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —à–∞–±–ª–æ–Ω —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
"""

print(__doc__)

print("\n–í–≤–µ–¥–∏—Ç–µ ID —à–∞–±–ª–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (–∏–ª–∏ Enter –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞):")
template_id = input("> ").strip()

if template_id:
    print(f"\n‚úÖ ID —à–∞–±–ª–æ–Ω–∞: {template_id}")
    print(f"‚úÖ –ü–∞–ø–∫–∞ –¥–ª—è –∫–æ–ø–∏–π: 1NkBvCFyFpXRg8Opno6-_Cf8mTeT7OHRA")
    print("\n–¢–µ–ø–µ—Ä—å —è –æ–±–Ω–æ–≤–ª—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–æ—Ç–∞...")
    
    # –û–±–Ω–æ–≤–ª—è–µ–º .env
    with open('.env', 'r', encoding='utf-8') as f:
        env_content = f.read()
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º TEMPLATE_SHEET_ID
    if 'TEMPLATE_SHEET_ID=' in env_content:
        lines = env_content.split('\n')
        new_lines = []
        for line in lines:
            if line.startswith('TEMPLATE_SHEET_ID='):
                new_lines.append(f'TEMPLATE_SHEET_ID={template_id}')
            else:
                new_lines.append(line)
        env_content = '\n'.join(new_lines)
    else:
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ GOOGLE_DRIVE_FOLDER_ID
        env_content = env_content.replace(
            'GOOGLE_DRIVE_FOLDER_ID=1NkBvCFyFpXRg8Opno6-_Cf8mTeT7OHRA',
            f'GOOGLE_DRIVE_FOLDER_ID=1NkBvCFyFpXRg8Opno6-_Cf8mTeT7OHRA\nTEMPLATE_SHEET_ID={template_id}'
        )
    
    with open('.env', 'w', encoding='utf-8') as f:
        f.write(env_content)
    
    print("‚úÖ –§–∞–π–ª .env –æ–±–Ω–æ–≤–ª—ë–Ω")
    print("\n–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å—Ç–∏—Ç–µ: python test_template_copy.py")
else:
    print("\n‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —à–∞–≥–∏ –≤—ã—à–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞.")
