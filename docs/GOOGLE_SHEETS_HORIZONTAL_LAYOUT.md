# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Google Sheets - –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞ —Å–∫–ª–∞–¥–æ–≤

**–î–∞—Ç–∞:** 23 –Ω–æ—è–±—Ä—è 2025 –≥.  
**–í–µ—Ä—Å–∏—è:** 2.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ **–Ω–æ–≤–∞—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Google Sheets** —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç—å—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–∫–ª–∞–¥–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤**
- ‚úÖ **2 —Å—Ç—Ä–æ–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤** –≤–º–µ—Å—Ç–æ 1
- ‚úÖ **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —è—á–µ–µ–∫** –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
- ‚úÖ **–í–∏–∑—É–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏**: –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è | –û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ | –°–∫–ª–∞–¥—ã

#### 2. **–†–∞—Å–∫–ª–∞–¥–∫–∞ —Å–∫–ª–∞–¥–æ–≤**
- ‚úÖ **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞**: –∫–∞–∂–¥—ã–π —Å–∫–ª–∞–¥ = 3 –∫–æ–ª–æ–Ω–∫–∏ (–û—Å—Ç–∞—Ç–∫–∏, –ó–∞–∫–∞–∑—ã, –û–±–æ—Ä–∞—á.)
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–ª–∞–¥–æ–≤**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è
- ‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–∫–ª–∞–¥–æ–≤**: –∏—Å–∫–ª—é—á–µ–Ω—ã "–í –ø—É—Ç–∏ –¥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π", "–û—Å—Ç–∞–ª—å–Ω—ã–µ" –∏ —Ç.–¥.

#### 3. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- ‚úÖ **–¢–æ–ª—Å—Ç—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã** (3px) –º–µ–∂–¥—É –ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ —Å–µ–∫—Ü–∏—è–º–∏
- ‚úÖ **–§–∏–æ–ª–µ—Ç–æ–≤—ã–π —Ñ–æ–Ω** –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (#6679EB) —Å –±–µ–ª—ã–º —Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ **–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫** –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
- ‚úÖ **–§–∏–∫—Å–∞—Ü–∏—è 2 —Å—Ç—Ä–æ–∫ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤** (–±–µ–∑ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–æ–ª–∑—É–Ω–∫–∞)

#### 4. **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö**
- ‚úÖ **–†–∞—Å—à–∏—Ä–µ–Ω–∞ –º–æ–¥–µ–ª—å Product**: –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –∏–∑ `ProductMetrics`
  - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã: `nm_id`, `wildberries_article`, `vendor_code`, `subject_id`
  - –û—Å—Ç–∞—Ç–∫–∏: `stocks_total`, `stocks_wb`, `stocks_mp`, `fbo_stock`, `fbs_stock`
  - –ó–∞–∫–∞–∑—ã: `orders_wb_warehouses`, `orders_fbs_warehouses`
  - –õ–æ–≥–∏—Å—Ç–∏–∫–∞: `in_transit_to_customer`, `in_transit_to_wb_warehouse`
  - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: `avg_orders_per_day`, `conversion_to_cart`, `buyout_percent`, –∏ –¥—Ä.
  - –°–∫–ª–∞–¥—ã: `stocks_by_warehouse`, `orders_by_warehouse` (JSONB)

---

## üìä –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

### –°—Ç—Ä–æ–∫–∞ 1: –ì—Ä—É–ø–ø—ã –∫–æ–ª–æ–Ω–æ–∫ (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ —è—á–µ–π–∫–∏)
```
| –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è | –û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏        | –°–∫–ª–∞–¥ 1     | –°–∫–ª–∞–¥ 2     | ... |
| (A1:D1)            | (E1:J1)              | (K1:M1)     | (N1:P1)     | ... |
```

### –°—Ç—Ä–æ–∫–∞ 2: –ù–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
```
| –ë—Ä–µ–Ω–¥ | –ü—Ä–µ–¥–º–µ—Ç | –ê—Ä—Ç–∏–∫—É–ª | NM ID | –í –ø—É—Ç–∏ | –ö–æ–Ω–≤. | –ó–∞–∫–∞–∑—ã WB | –ó–∞–∫–∞–∑—ã | –û—Å—Ç–∞—Ç–∫–∏ | –û–±–æ—Ä. | –û—Å—Ç–∞—Ç–∫–∏ | –ó–∞–∫–∞–∑—ã | –û–±–æ—Ä. | ...
```

### –°—Ç—Ä–æ–∫–∞ 3+: –î–∞–Ω–Ω—ã–µ
```
| ITS   | –ö–æ–ª–ª–∞–≥–µ–Ω| COL-001 | 12345 | 5      | 2     | 50        | 50     | 100     | 10    | 40      | 20     | 2.0   | ...
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```python
NUM_BASE_INFO_COLS = 4          # A-D: –ë—Ä–µ–Ω–¥, –ü—Ä–µ–¥–º–µ—Ç, –ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞, NM ID
NUM_GENERAL_METRICS_COLS = 6    # E-J: –õ–æ–≥–∏—Å—Ç–∏–∫–∞ + –æ–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏
NUM_WAREHOUSE_COLS = 3          # –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∫–ª–∞–¥–∞: –û—Å—Ç–∞—Ç–∫–∏, –ó–∞–∫–∞–∑—ã, –û–±–æ—Ä–∞—á.
```

### –®–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
- –ë—Ä–µ–Ω–¥: 150px
- –ü—Ä–µ–¥–º–µ—Ç: 200px
- –ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞: 180px
- NM ID: 150px
- –û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏: 120px
- –ö–æ–ª–æ–Ω–∫–∏ —Å–∫–ª–∞–¥–æ–≤: 90px

### –í—ã—Å–æ—Ç–∞ —Å—Ç—Ä–æ–∫
- –°—Ç—Ä–æ–∫–∞ 1 (–≥—Ä—É–ø–ø—ã): 35px
- –°—Ç—Ä–æ–∫–∞ 2 (–∑–∞–≥–æ–ª–æ–≤–∫–∏): 40px

---

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. **Google Sheets Service**
**–§–∞–π–ª:** `Stock-Tracker/src/stock_tracker/services/google_sheets_service.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ü–µ—Ä–µ–ø–∏—Å–∞–Ω `sync_products_to_sheet()` –¥–ª—è –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `_merge_and_write_group_headers()` - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —è—á–µ–µ–∫
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `_apply_full_formatting()` - –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `_apply_dimension_properties()` - —à–∏—Ä–∏–Ω–∞/–≤—ã—Å–æ—Ç–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `_format_headers()` - —Å—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `_format_data_cells()` - –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `_apply_borders()` - –≥—Ä–∞–Ω–∏—Ü—ã –º–µ–∂–¥—É —Å–µ–∫—Ü–∏—è–º–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `_col_number_to_letter()` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è A/B/C...
- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω `_setup_sheet_formatting()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

### 2. **–ú–æ–¥–µ–ª—å Product**
**–§–∞–π–ª:** `Stock-Tracker/src/stock_tracker/database/models/product.py`

**–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è:**
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã: `nm_id`, `wildberries_article`, `vendor_code`, `subject_id`
- –ù–∞–∑–≤–∞–Ω–∏—è: `product_name`, `brand_name`, `subject`
- –û—Å—Ç–∞—Ç–∫–∏: `stocks_total`, `stocks_wb`, `stocks_mp`, `fbo_stock`, `fbs_stock`
- –ó–∞–∫–∞–∑—ã: `orders_wb_warehouses`, `orders_fbs_warehouses`
- –õ–æ–≥–∏—Å—Ç–∏–∫–∞: `in_way_to_client`, `in_transit_to_customer`, `in_way_from_client`, `in_transit_to_wb_warehouse`
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞: `avg_orders_per_day`, `conversion_to_cart`, `conversion_to_order`, `buyout_percent`, `avg_price`, `order_sum_total`, `buyout_count`, `buyout_sum`
- –°–∫–ª–∞–¥—ã: `stocks_by_warehouse`, `orders_by_warehouse` (JSONB)
- Aliases: `turnover`, `last_updated`

### 3. **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î**
**–§–∞–π–ª:** `Stock-Tracker/migrations/versions/20251123_add_product_metrics_fields.py`

**–î–µ–π—Å—Ç–≤–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü—É `products`
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è `nm_id`, `wildberries_article`, `vendor_code`
- ‚úÖ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ alias-–ø–æ–ª—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ rollback (downgrade)

### 4. **–¢–µ—Å—Ç—ã**
**–§–∞–π–ª:** `Stock-Tracker/tests/test_new_sheets_structure.py`

**–ü–æ–∫—Ä—ã—Ç–∏–µ:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ –¢–µ—Å—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –Ω–æ–º–µ—Ä–∞ –∫–æ–ª–æ–Ω–∫–∏ –≤ –±—É–∫–≤—É
- ‚úÖ –¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–∫–ª–∞–¥–æ–≤
- ‚úÖ –¢–µ—Å—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- ‚úÖ –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ edge cases (–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –Ω–µ—Ç —Å–∫–ª–∞–¥–æ–≤)
- ‚úÖ –¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–ª–æ–Ω–æ–∫
- ‚úÖ –¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ –≥—Ä–∞–Ω–∏—Ü –º–µ–∂–¥—É —Å–µ–∫—Ü–∏—è–º–∏

### 5. **–ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç**
**–§–∞–π–ª:** `Stock-Tracker/scripts/migrate_sheets_to_horizontal_layout.py`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö tenant'–æ–≤ –∏–ª–∏ –æ–¥–Ω–æ–≥–æ –ø–æ ID
- ‚úÖ –†–µ–∂–∏–º dry-run –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –ª–∏—Å—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

---

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
```powershell
cd Stock-Tracker
alembic upgrade head
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
```powershell
pytest tests/test_new_sheets_structure.py -v
```

### –®–∞–≥ 3: –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Google Sheets (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - dry-run)
```powershell
python scripts/migrate_sheets_to_horizontal_layout.py --dry-run --backup
```

### –®–∞–≥ 4: –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Google Sheets (—Ä–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫)
```powershell
# –í—Å–µ tenant'—ã —Å —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏
python scripts/migrate_sheets_to_horizontal_layout.py --backup

# –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω tenant
python scripts/migrate_sheets_to_horizontal_layout.py --tenant-id <TENANT_ID> --backup
```

---

## üì∏ –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

### –°—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è)
```
| –ë—Ä–µ–Ω–¥ | –ü—Ä–µ–¥–º–µ—Ç | –ê—Ä—Ç–∏–∫—É–ª | –í –ø—É—Ç–∏ | –ö–æ–Ω–≤. | –ó–∞–∫–∞–∑—ã | –°–∫–ª–∞–¥ 1 | –°–∫–ª–∞–¥ 2 | ... |
|-------|---------|---------|--------|-------|--------|---------|---------|-----|
| ITS   | –ö–æ–ª–ª–∞–≥–µ–Ω| COL-001 | 5      | 2     | 50     | 40      | 35      | ... |
```
- 1 —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –°–∫–ª–∞–¥—ã - –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –±–µ–∑ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
- –ù–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π

### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è)
```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è   ‚ïë –û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏            ‚ïë –ö–æ–ª–µ–¥–∏–Ω–æ   ‚ïë –ü–æ–¥–æ–ª—å—Å–∫   ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë –ë—Ä–µ–Ω–¥ ‚îÇ –ü—Ä–µ–¥–º–µ—Ç ‚îÇ ... ‚ïë –í –ø—É—Ç–∏‚îÇ –ó–∞–∫–∞–∑—ã ‚îÇ –û—Å—Ç–∞—Ç–∫–∏ ‚ïë –û—Å—Ç.‚îÇ–ó–∞–∫–∫–∞–∑—ã‚ïë –û—Å—Ç.‚îÇ–ó–∞–∫–∞–∑—ã‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë ITS   ‚îÇ–ö–æ–ª–ª–∞–≥–µ–Ω ‚îÇ ... ‚ïë   5   ‚îÇ   50   ‚îÇ   100   ‚ïë  40 ‚îÇ  20  ‚ïë  35 ‚îÇ  18  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```
- 2 —Å—Ç—Ä–æ–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º
- –í–∏–∑—É–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ —Å —Ç–æ–ª—Å—Ç—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
- –ö–∞–∂–¥—ã–π —Å–∫–ª–∞–¥ = –≥—Ä—É–ø–ø–∞ –∏–∑ 3 –∫–æ–ª–æ–Ω–æ–∫

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### 1. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** üìñ
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å–µ–∫—Ü–∏–∏
- –í–∏–∑—É–∞–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–∞–±–ª–∏—Ü–µ

### 2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** üìà
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å–∫–ª–∞–¥—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–ª–∞–¥–æ–≤

### 3. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** üìä
- –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –∫–∞–∂–¥–æ–º—É —Å–∫–ª–∞–¥—É –æ—Ç–¥–µ–ª—å–Ω–æ
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–≤ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
- –ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤

### 4. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** üîÑ
- –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å `ProductMetrics`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ alias-–ø–æ–ª–µ–π –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –ú–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### 1. **–û–±—Ä–∞—Ç–Ω–∞—è –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
–°—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–æ–ª—å—à–µ –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è. –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

### 2. **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏**
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ü–∏—é `--backup` –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π.

### 3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ–ª—å—à–µ batch_update –æ–ø–µ—Ä–∞—Ü–∏–π, –Ω–æ –æ–Ω–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ API –≤—ã–∑–æ–≤–æ–≤.

### 4. **–°–ª—É–∂–µ–±–Ω—ã–µ —Å–∫–ª–∞–¥—ã**
–°–ª–µ–¥—É—é—â–∏–µ —Å–∫–ª–∞–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è:
- "–í –ø—É—Ç–∏ –¥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π"
- "–í –ø—É—Ç–∏ –≤–æ–∑–≤—Ä–∞—Ç—ã –Ω–∞ —Å–∫–ª–∞–¥ WB"
- "–í—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å–∫–ª–∞–¥–∞—Ö"
- "–û—Å—Ç–∞–ª—å–Ω—ã–µ"

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ —è—á–µ–µ–∫
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ª–∏—Å—Ç –Ω–µ –∏–º–µ–µ—Ç –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Quota exceeded –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É tenant'–∞–º–∏ –∏–ª–∏ –º–∏–≥—Ä–∏—Ä—É–π—Ç–µ –ø–æ –æ–¥–Ω–æ–º—É

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ `alembic upgrade head` –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –ë–î

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `logs/sheets_migration.log`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã: `pytest tests/test_new_sheets_structure.py`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dry-run —Ä–µ–∂–∏–º –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª—å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–µ–π

---

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### v2.0 (23.11.2025)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–æ–≤–∞—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è ProductMetrics –≤ –º–æ–¥–µ–ª—å
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
- ‚úÖ –ù–∞–ø–∏—Å–∞–Ω—ã —Ç–µ—Å—Ç—ã
- ‚úÖ –°–æ–∑–¥–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç

### v1.0 (–ø—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è)
- –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å 1 —Å—Ç—Ä–æ–∫–æ–π –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –°–∫–ª–∞–¥—ã —á–µ—Ä–µ–∑ `\n\n` —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞:** 23 –Ω–æ—è–±—Ä—è 2025 –≥.  
**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
