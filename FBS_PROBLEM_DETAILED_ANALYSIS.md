# üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´ FBS –û–°–¢–ê–¢–ö–û–í

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 30 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Å—Ç–∞—Ç–∫–∏ Fulllog FBS –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤

---

## üìä –¢–ï–ö–£–©–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø

### –ê—Ä—Ç–∏–∫—É–ª—ã —Å –ü–†–û–ë–õ–ï–ú–ê–ú–ò:

| –ê—Ä—Ç–∏–∫—É–ª | WB –û—Å—Ç–∞—Ç–∫–∏ (–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å) | Tracker –û—Å—Ç–∞—Ç–∫–∏ (Fulllog FBS) | –†–∞–∑–Ω–∏—Ü–∞ |
|---------|-------------------------|-------------------------------|---------|
| **Its2/50g** | **1884 —à—Ç** | **0 —à—Ç** | ‚ùå **-1884** |
| **ItsSport2/50g** | **957 —à—Ç** | **0 —à—Ç** | ‚ùå **-957** |
| Its1_2_3/50g | 2815 —à—Ç | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ | ‚ùå –ù–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è |

### –ê—Ä—Ç–∏–∫—É–ª—ã –ë–ï–ó –ü–†–û–ë–õ–ï–ú:

| –ê—Ä—Ç–∏–∫—É–ª | WB –û—Å—Ç–∞—Ç–∫–∏ | Tracker –û—Å—Ç–∞—Ç–∫–∏ | –°—Ç–∞—Ç—É—Å |
|---------|------------|-----------------|--------|
| Its2/50g+Aks5/20g.FBS | 175 | 175 | ‚úÖ |
| ItsSport2/50g+Aks5/20g.FBS | 175 | 175 | ‚úÖ |
| Its1_2_3/50g+Aks5/20g.FBS | 175 | 175 | ‚úÖ |
| Its1_2_3/50g+AksRecov/20g | 185 | 185 | ‚úÖ |

---

## üîé –ö–õ–Æ–ß–ï–í–û–ï –ù–ê–ë–õ–Æ–î–ï–ù–ò–ï

### –ó–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:

1. ‚úÖ **–ê—Ä—Ç–∏–∫—É–ª—ã —Å `.FBS` –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏** ‚Üí –û—Å—Ç–∞—Ç–∫–∏ –ó–ê–ü–ò–°–´–í–ê–Æ–¢–°–Ø –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. ‚ùå **–ê—Ä—Ç–∏–∫—É–ª—ã –ë–ï–ó `.FBS` –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏** ‚Üí –û—Å—Ç–∞—Ç–∫–∏ —Å –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ –¢–ï–†–Ø–Æ–¢–°–Ø

**–ü—Ä–∏–º–µ—Ä:**
- `Its2/50g+Aks5/20g.FBS` (552086752) ‚Üí ‚úÖ 175 –æ—Å—Ç–∞—Ç–∫–æ–≤ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- `Its2/50g` (163383327) ‚Üí ‚ùå 1884 –æ—Å—Ç–∞—Ç–∫–∞ –ù–ï —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è

---

## üß© –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –û–ë–†–ê–ë–û–¢–ö–ò FBS

### 1. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         WILDBERRIES API v1 (Statistics API)             ‚îÇ
‚îÇ    GET /api/v1/supplier/stocks                         ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏ –ü–û –í–°–ï–ú —Å–∫–ª–∞–¥–∞–º:                    ‚îÇ
‚îÇ  ‚Ä¢ FBO —Å–∫–ª–∞–¥—ã (–ß–µ—Ö–æ–≤, –ö–æ–ª–µ–¥–∏–Ω–æ, –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä...)          ‚îÇ
‚îÇ  ‚Ä¢ FBS —Å–∫–ª–∞–¥—ã (–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              –û–ë–†–ê–ë–û–¢–ö–ê –í calculator.py                   ‚îÇ
‚îÇ       group_data_by_product()                           ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  1. –ü–∞—Ä—Å–∏—Ç –≤—Å–µ —Å–∫–ª–∞–¥—ã –∏–∑ API                            ‚îÇ
‚îÇ  2. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ normalize_warehouse_name()‚îÇ
‚îÇ  3. –§–∏–ª—å—Ç—Ä—É–µ—Ç —á–µ—Ä–µ–∑ is_real_warehouse()                 ‚îÇ
‚îÇ  4. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç FBS —á–µ—Ä–µ–∑ is_marketplace_warehouse()     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           –ó–ê–ü–ò–°–¨ –í GOOGLE SHEETS                        ‚îÇ
‚îÇ      operations.py ‚Üí create_product()                   ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üêõ –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê –ü–†–û–ë–õ–ï–ú–´

### –ì–∏–ø–æ—Ç–µ–∑–∞ #1: –†–∞–∑–ª–∏—á–∏–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö API

**–ê—Ä—Ç–∏–∫—É–ª—ã –î–í–ê –¢–ò–ü–ê:**

#### –¢–∏–ø A: –ê—Ä—Ç–∏–∫—É–ª—ã –° —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `.FBS` –≤ vendorCode
```json
{
  "nmId": 552086752,
  "vendorCode": "Its2/50g+Aks5/20g.FBS",
  "warehouses": [
    {
      "warehouseName": "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å",
      "quantity": 175
    }
  ]
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –°–∫–ª–∞–¥ "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å" –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ "Fulllog FBS"

#### –¢–∏–ø B: –ê—Ä—Ç–∏–∫—É–ª—ã –ë–ï–ó —Å—É—Ñ—Ñ–∏–∫—Å–∞ `.FBS`
```json
{
  "nmId": 163383327,
  "vendorCode": "Its2/50g",
  "warehouses": [
    {
      "warehouseName": "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å",
      "quantity": 1884
    },
    {
      "warehouseName": "–ß–µ—Ö–æ–≤ 1", 
      "quantity": 212
    },
    // ... –¥—Ä—É–≥–∏–µ —Å–∫–ª–∞–¥—ã
  ]
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå –°–∫–ª–∞–¥ "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å" –ù–ï –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è!

---

## üîç –ê–ù–ê–õ–ò–ó –ö–û–î–ê

### –ü—Ä–æ–±–ª–µ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ `group_data_by_product()`:

```python
# –°—Ç—Ä–æ–∫–∞ 531 - calculator.py
warehouse_name = normalize_warehouse_name(warehouse_name_raw)

# –°—Ç—Ä–æ–∫–∞ 537 - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–∫–ª–∞–¥–∞
if warehouse_name and is_real_warehouse(warehouse_name):
    
    # –°—Ç—Ä–æ–∫–∞ 539 - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
    if is_marketplace_warehouse(warehouse_name):
        marketplace_warehouses_detected.append({...})
        logger.info(f"üè™ MARKETPLACE INCLUDED: '{warehouse_name_raw}'...")
```

### –ü—Ä–æ–±–ª–µ–º–∞: normalize_warehouse_name()

**–§–∞–π–ª:** `src/stock_tracker/utils/warehouse_mapper.py`

```python
def normalize_warehouse_name(raw_name: str) -> str:
    """–ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∫–ª–∞–¥–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –∫–∞—Ä—Ç–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–∫–ª–∞–¥–æ–≤."""
    
    # –®–∞–≥ 1: –ü–æ–∏—Å–∫ –≤ CANONICAL_WAREHOUSE_MAP
    for canonical, variations in CANONICAL_WAREHOUSE_MAP.items():
        for variation in variations:
            if variation.lower() == raw_name.lower():
                return canonical  # ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å"
    
    # –®–∞–≥ 2: –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª
    return raw_name  # ‚ö†Ô∏è –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞: CANONICAL_WAREHOUSE_MAP

```python
CANONICAL_WAREHOUSE_MAP = {
    "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å": [
        "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å", "–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å", "–ú–ê–†–ö–ï–¢–ü–õ–ï–ô–°",
        "Marketplace", "marketplace", "MARKETPLACE",
        "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å-1", "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å 1", "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å1",
        # ... –æ–∫–æ–ª–æ 30 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
    ],
    # ... –¥—Ä—É–≥–∏–µ —Å–∫–ª–∞–¥—ã
}
```

---

## üéØ –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´

### –¢–µ–æ—Ä–∏—è #1: –†–∞–∑–ª–∏—á–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å" –≤ API

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** üü° –°—Ä–µ–¥–Ω—è—è

WB API –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤:
- –î–ª—è FBS —Ç–æ–≤–∞—Ä–æ–≤: `"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å"` (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π)
- –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤: `"–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å "` (—Å –ø—Ä–æ–±–µ–ª–æ–º), `"–ú–ü"`, `"Marketplace"`, etc.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# –ù—É–∂–Ω–æ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å RAW –Ω–∞–∑–≤–∞–Ω–∏—è –∏–∑ API –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤
logger.info(f"RAW warehouse name from API: '{warehouse_name_raw}' (repr: {repr(warehouse_name_raw)})")
```

### –¢–µ–æ—Ä–∏—è #2: –õ–æ–≥–∏–∫–∞ is_real_warehouse() –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ—Ç —Å–∫–ª–∞–¥

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** üî¥ –í—ã—Å–æ–∫–∞—è

**–§–∞–π–ª:** `src/stock_tracker/core/calculator.py`, —Å—Ç—Ä–æ–∫–∞ 65

```python
def is_real_warehouse(warehouse_name: str) -> bool:
    # ... –ø—Ä–æ–≤–µ—Ä–∫–∏ ...
    
    # –ü–†–ò–û–†–ò–¢–ï–¢ #1 - –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å/FBS —Å–∫–ª–∞–¥—ã
    marketplace_indicators = [
        "–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å", "marketplace", 
        "—Å–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞", "—Å–∫–ª–∞–¥ —Å–µ–ª–ª–µ—Ä–∞",
        "fbs", "fulfillment by seller",
        "–º–ø", "mp",  # –ë–ï–ó –ø—Ä–æ–±–µ–ª–æ–≤
    ]
    
    if any(indicator in warehouse_name_lower for indicator in marketplace_indicators):
        logger.info(f"‚úÖ Marketplace/FBS warehouse: {warehouse_name}")
        return True
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ `normalize_warehouse_name()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á—Ç–æ-—Ç–æ –ö–†–û–ú–ï —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è - —Å–∫–ª–∞–¥ –±—É–¥–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω!

### –¢–µ–æ—Ä–∏—è #3: –ü—Ä–æ–±–ª–µ–º–∞ –≤ –∑–∞–ø–∏—Å–∏ –≤ Sheets (formatter.py)

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** üü¢ –ù–∏–∑–∫–∞—è

–ü—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `warehouse_mapper.py` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π:

```python
# warehouse_mapper.py
def map_warehouse_to_display_name(canonical_name: str) -> str:
    """–ú–∞–ø–ø–∏–Ω–≥ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ."""
    display_map = {
        "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å": "Fulllog FBS",
        # ...
    }
    return display_map.get(canonical_name, canonical_name)
```

–ï—Å–ª–∏ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–µ –∏–º—è –Ω–µ "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å", –æ–Ω–æ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ –≤ "Fulllog FBS".

---

## üî¨ –¢–ï–°–¢–û–í–´–ô –°–¶–ï–ù–ê–†–ò–ô

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
# –í group_data_by_product(), —Å—Ç—Ä–æ–∫–∞ ~520
for warehouse in item["warehouses"]:
    warehouse_name_raw = warehouse.get("warehouseName", "")
    quantity = warehouse.get("quantity", 0)
    
    # üîç –î–û–ë–ê–í–ò–¢–¨ –î–ï–¢–ê–õ–¨–ù–û–ï –õ–û–ì–ò–†–û–í–ê–ù–ò–ï
    logger.info(f"üîç WAREHOUSE DEBUG:")
    logger.info(f"   Article: {supplier_article} (nmId: {nm_id})")
    logger.info(f"   Raw name: '{warehouse_name_raw}' (repr: {repr(warehouse_name_raw)})")
    logger.info(f"   Quantity: {quantity}")
    
    warehouse_name = normalize_warehouse_name(warehouse_name_raw)
    logger.info(f"   Normalized: '{warehouse_name}'")
    
    is_real = is_real_warehouse(warehouse_name)
    logger.info(f"   is_real_warehouse: {is_real}")
    
    is_marketplace = is_marketplace_warehouse(warehouse_name)
    logger.info(f"   is_marketplace_warehouse: {is_marketplace}")
    
    if not is_real:
        logger.warning(f"   ‚ùå WAREHOUSE FILTERED OUT!")
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞

```bash
python update_table_fixed.py
# –ò–ª–∏ —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç:
python -c "from stock_tracker.core.calculator import WildberriesCalculator; ..."
```

### –®–∞–≥ 3: –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏

–ò—Å–∫–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã:
- –ö–∞–∫–æ–µ RAW –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –¥–ª—è "Its2/50g" vs "Its2/50g+Aks5/20g.FBS"
- –ü—Ä–æ—Ö–æ–¥–∏—Ç –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É `is_real_warehouse()`
- –ö–∞–∫–æ–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è

---

## üí° –†–ï–®–ï–ù–ò–Ø

### –†–µ—à–µ–Ω–∏–µ #1: –†–∞—Å—à–∏—Ä–∏—Ç—å CANONICAL_WAREHOUSE_MAP (–í—Ä–µ–º–µ–Ω–Ω–æ–µ)

**–§–∞–π–ª:** `src/stock_tracker/utils/warehouse_mapper.py`

```python
CANONICAL_WAREHOUSE_MAP = {
    "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å": [
        # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã...
        "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å", "marketplace",
        
        # üÜï –î–û–ë–ê–í–ò–¢–¨ –í–û–ó–ú–û–ñ–ù–´–ï –í–ê–†–ò–ê–ù–¢–´
        "–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞",
        "Seller warehouse",
        "FBS",
        "Fulfillment by Seller",
        "–ú–ü",
        "MP",
        # –í—Å–µ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
        "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å ", 
        "Marketplace ",
        " –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å",
        " Marketplace",
    ],
}
```

**–ü–ª—é—Å—ã:** 
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ —Ä–µ—à–∞–µ—Ç –∫–æ—Ä–Ω–µ–≤—É—é –ø—Ä–æ–±–ª–µ–º—É
- ‚ùå –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –†–µ—à–µ–Ω–∏–µ #2: –£–ª—É—á—à–∏—Ç—å normalize_warehouse_name() (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–î–æ–±–∞–≤–∏—Ç—å –Ω–µ—á–µ—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ:**

```python
def normalize_warehouse_name(raw_name: str) -> str:
    """–ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∫–ª–∞–¥–∞ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π."""
    if not raw_name:
        return ""
    
    # –û—á–∏—Å—Ç–∫–∞
    cleaned = raw_name.strip()
    cleaned_lower = cleaned.lower()
    
    # –®–∞–≥ 1: –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
    for canonical, variations in CANONICAL_WAREHOUSE_MAP.items():
        for variation in variations:
            if variation.lower() == cleaned_lower:
                return canonical
    
    # üÜï –®–∞–≥ 2: –ù–µ—á–µ—Ç–∫–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –¥–ª—è –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
    marketplace_fuzzy = [
        "–º–∞—Ä–∫–µ—Ç", "market", "–º–ø", "mp",
        "—Å–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞", "seller", "fbs"
    ]
    
    if any(indicator in cleaned_lower for indicator in marketplace_fuzzy):
        logger.info(f"‚úÖ Fuzzy match detected Marketplace: '{raw_name}'")
        return "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å"
    
    # –®–∞–≥ 3: –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–∫–ª–∞–¥–æ–≤
    # ...
    
    # –®–∞–≥ 4: –í–æ–∑–≤—Ä–∞—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
    return cleaned
```

### –†–µ—à–µ–Ω–∏–µ #3: –î–æ–±–∞–≤–∏—Ç—å fallback –≤ is_real_warehouse()

**–§–∞–π–ª:** `src/stock_tracker/core/calculator.py`

```python
def is_real_warehouse(warehouse_name: str) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–∫–ª–∞–¥ —Ä–µ–∞–ª—å–Ω—ã–º (–Ω–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º)."""
    
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ ...
    
    # üÜï FALLBACK: –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ > 0 –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–µ –ø—É—Å—Ç–æ–µ
    # –ò –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å–∫–ª—é—á–∞—é—â–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ - –í–ö–õ–Æ–ß–ê–ï–ú
    excluding_patterns = ["–≤ –ø—É—Ç–∏", "in transit", "–≤–∏—Ä—Ç—É–∞–ª—å–Ω", "virtual"]
    
    if warehouse_name and len(warehouse_name) > 2:
        has_excluding = any(pattern in warehouse_name_lower for pattern in excluding_patterns)
        if not has_excluding:
            logger.info(f"‚úÖ Warehouse included by fallback: {warehouse_name}")
            return True
    
    return False
```

### –†–µ—à–µ–Ω–∏–µ #4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å warehouseType –∏–∑ API (–ò–î–ï–ê–õ–¨–ù–û–ï)

**–ü—Ä–æ–±–ª–µ–º–∞:** WB API `/api/v1/supplier/stocks` –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `warehouseType`

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ `/supplier/orders` –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```python
# –í group_data_by_product()
# –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ warehouse_remains_data —Å–æ—Ö—Ä–∞–Ω—è—Ç—å mapping:
warehouse_type_map = {}  # {warehouse_name: warehouse_type}

# –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ orders_data –∑–∞–ø–æ–ª–Ω—è—Ç—å:
for order in orders_data:
    wh_name = order.get("warehouseName")
    wh_type = order.get("warehouseType")  # "–°–∫–ª–∞–¥ WB" –∏–ª–∏ "–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞"
    if wh_name and wh_type:
        warehouse_type_map[wh_name] = wh_type

# –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–∫–ª–∞–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
if warehouse_name not in group["warehouses"]:
    warehouse_type = warehouse_type_map.get(warehouse_name, "unknown")
    is_fbs = warehouse_type == "–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞"
    
    group["warehouses"][warehouse_name] = {
        "stock": quantity,
        "orders": 0,
        "warehouse_type": warehouse_type,
        "is_fbs": is_fbs,  # ‚úÖ –¢–æ—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ API
        "raw_name": warehouse_name_raw
    }
```

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –¢–û–ß–ö–ò –ü–†–û–í–ï–†–ö–ò

### 1. –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ API

```python
# –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ group_data_by_product()
logger.info("="*80)
logger.info("üîç API INPUT DATA DEBUG")
logger.info("="*80)

for item in warehouse_remains_data:
    if item.get("vendorCode") in ["Its2/50g", "ItsSport2/50g"]:
        logger.info(f"\nüì¶ Product: {item.get('vendorCode')} (nmId: {item.get('nmId')})")
        logger.info(f"   Warehouses count: {len(item.get('warehouses', []))}")
        for wh in item.get("warehouses", []):
            logger.info(f"   - '{wh.get('warehouseName')}': {wh.get('quantity')} —à—Ç")
```

### 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

```python
# –í normalize_warehouse_name()
result = # ... –ª–æ–≥–∏–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ ...

if "–º–∞—Ä–∫–µ—Ç" in raw_name.lower() or "market" in raw_name.lower():
    logger.info(f"üîç NORMALIZATION: '{raw_name}' -> '{result}'")
    
return result
```

### 3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

```python
# –í is_real_warehouse()
result = # ... –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ ...

if not result and ("–º–∞—Ä–∫–µ—Ç" in warehouse_name.lower() or "–º–ø" in warehouse_name.lower()):
    logger.warning(f"‚ö†Ô∏è POTENTIAL MARKETPLACE FILTERED: '{warehouse_name}'")
    
return result
```

### 4. –ó–∞–ø–∏—Å—å –≤ —Å–ª–æ–≤–∞—Ä—å

```python
# –í group_data_by_product() –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è warehouse
logger.info(f"‚úÖ Warehouse STORED:")
logger.info(f"   Key: {warehouse_name}")
logger.info(f"   Stock: {group['warehouses'][warehouse_name]['stock']}")
logger.info(f"   is_fbs: {group['warehouses'][warehouse_name]['is_fbs']}")
```

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –§–∞–∑–∞ 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (30 –º–∏–Ω—É—Ç)

1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏
2. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
3. ‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ –¥–ª—è –∞—Ä—Ç–∏–∫—É–ª–æ–≤ Its2/50g –∏ ItsSport2/50g
4. ‚úÖ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

### –§–∞–∑–∞ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (1 —á–∞—Å)

**–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –†–∞—Å—à–∏—Ä–∏—Ç—å CANONICAL_WAREHOUSE_MAP
- –î–æ–±–∞–≤–∏—Ç—å –Ω–µ—á–µ—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

**–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- –£–ª—É—á—à–∏—Ç—å is_real_warehouse()
- –î–æ–±–∞–≤–∏—Ç—å fallback –ª–æ–≥–∏–∫—É

**–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ FBS:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å warehouseType –∏–∑ orders
- –£–ª—É—á—à–∏—Ç—å is_marketplace_warehouse()

### –§–∞–∑–∞ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (30 –º–∏–Ω—É—Ç)

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª—ã —Ç–µ–ø–µ—Ä—å –∏–º–µ—é—Ç Fulllog FBS –æ—Å—Ç–∞—Ç–∫–∏
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –¥—Ä—É–≥–∏–µ –∞—Ä—Ç–∏–∫—É–ª—ã –Ω–µ —Å–ª–æ–º–∞–ª–∏—Å—å
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `compare_wb_vs_tracker.py`

### –§–∞–∑–∞ 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (15 –º–∏–Ω—É—Ç)

1. –û–±–Ω–æ–≤–∏—Ç—å CHANGELOG
2. –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É
3. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

| –ê—Ä—Ç–∏–∫—É–ª | WB –û—Å—Ç–∞—Ç–∫–∏ | Tracker –û—Å—Ç–∞—Ç–∫–∏ | –°—Ç–∞—Ç—É—Å |
|---------|------------|-----------------|--------|
| Its2/50g | 1884 | 1884 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |
| ItsSport2/50g | 957 | 957 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |
| Its1_2_3/50g | 2815 | 2815 | ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û |

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** 100% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ "–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å" (WB) = "Fulllog FBS" (Tracker) –¥–ª—è –í–°–ï–• –∞—Ä—Ç–∏–∫—É–ª–æ–≤.

---

## üîó –°–í–Ø–ó–ê–ù–ù–´–ï –§–ê–ô–õ–´

### –î–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- `src/stock_tracker/core/calculator.py` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- `src/stock_tracker/utils/warehouse_mapper.py` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫–ª–∞–¥–æ–≤
- `src/stock_tracker/database/formatter.py` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Sheets

### –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- `update_table_fixed.py` - —Å–∫—Ä–∏–ø—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `compare_wb_vs_tracker.py` - —Å–∫—Ä–∏–ø—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç–æ—á–Ω–æ–π –ø—Ä–∏—á–∏–Ω—ã.
