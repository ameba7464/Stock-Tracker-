# üéâ –û–¢–ß–ï–¢ –û –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô –°–ö–õ–ê–î–û–í WILDBERRIES STOCK TRACKER

**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: 24 –æ–∫—Ç—è–±—Ä—è 2025 –≥.  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç**: WAREHOUSE_ISSUES_FIX_PROMPT.md  

## üìã –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò

### ‚úÖ –§–∞–∑–∞ 1: –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### 1.1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `is_real_warehouse()` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–∫–ª–∞–¥–æ–≤ –ú–ü
**–§–∞–π–ª**: `src/stock_tracker/core/calculator.py`
**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∫–ª–∞–¥–æ–≤ –ø—Ä–æ–¥–∞–≤—Ü–∞ —Å —Ç–∏–ø–æ–º "–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞"
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ú–ü: ["–º–ø", "–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å", "—Å–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞", "—Å–ø ", "sp "]
- –°–∫–ª–∞–¥—ã –ú–ü —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç—ã
- –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

#### 1.2. ‚úÖ –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `group_data_by_product()` 
**–§–∞–π–ª**: `src/stock_tracker/core/calculator.py`
**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—è `warehouseType` –∏–∑ API
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∫–ª–∞–¥–æ–≤ —Å –Ω—É–ª–µ–≤—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∑–∞–∫–∞–∑–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Å–∫–ª–∞–¥–æ–≤: "–°–∫–ª–∞–¥ WB", "–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞"
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–∏–ø —Å–∫–ª–∞–¥–∞ –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ warehouse_remains

#### 1.3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `calculate_total_orders_with_debug()`
**–§–∞–π–ª**: `src/stock_tracker/core/calculator.py`
**–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
- –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞
- –†–∞–∑–±–∏–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Å–∫–ª–∞–¥–æ–≤ (WB vs –ú–ü)
- –ê–Ω–∞–ª–∏–∑ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–∫–ª–∞–¥–∞–º –∏ —Ç–∏–ø–∞–º
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

#### 1.4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `validate_orders_calculation()`
**–§–∞–π–ª**: `src/stock_tracker/core/calculator.py`
**–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—É–º–º—ã –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Å–∫–ª–∞–¥–∞–º –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É
- –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è—Ö
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è—Ö

### ‚úÖ –§–∞–∑–∞ 2: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

#### 2.1. ‚úÖ –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `calculation_verifier.py`
**–§–∞–π–ª**: `src/stock_tracker/utils/calculation_verifier.py`
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
- –ö–ª–∞—Å—Å `CalculationVerifier` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ WB
- –ú–µ—Ç–æ–¥ `verify_orders_accuracy()` –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ –æ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è—Ö
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é
- –ö–ª–∞—Å—Å `AccuracyMonitor` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤

#### 2.2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `fetch_supplier_orders_precise()`
**–§–∞–π–ª**: `src/stock_tracker/api/products.py`
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
- –¢–æ—á–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ (–∫–∞–∫ –≤ WB)
- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –ª–æ–≥–∏–∫–æ–π WB –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

#### 2.3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `sync_product_with_verification()`
**–§–∞–π–ª**: `src/stock_tracker/services/product_service.py`
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–æ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ WB
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

#### 2.4. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ `diagnose_article_issues.py`
**–§–∞–π–ª**: `diagnose_article_issues.py`
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**:
- CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∞—Ä—Ç–∏–∫—É–ª–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ 163383326 –∏–∑ –ø—Ä–∏–º–µ—Ä–∞
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### 1. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∫–ª–∞–¥–æ–≤ –ø—Ä–æ–¥–∞–≤—Ü–∞ (–ú–ü)
```python
# –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –≤ is_real_warehouse()
mp_indicators = ["–º–ø", "–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å", "—Å–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞", "—Å–ø ", "sp "]
warehouse_name_lower = warehouse_name.lower()

if any(indicator in warehouse_name_lower for indicator in mp_indicators):
    logger.debug(f"Identified MP warehouse: {warehouse_name}")
    return True
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ warehouseType
```python
# –í group_data_by_product()
warehouse_type = order.get("warehouseType")
is_valid_warehouse_type = (
    warehouse_type in ["–°–∫–ª–∞–¥ WB", "–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞"] or 
    warehouse_type is None
)
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫–ª–∞–¥–æ–≤ —Å –Ω—É–ª–µ–≤—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–∫–∞–∑–æ–≤
if warehouse_name not in group["warehouses"]:
    group["warehouses"][warehouse_name] = {
        "stock": 0,  # –ë—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –∏–∑ warehouse_remains
        "orders": 0,
        "warehouse_type": warehouse_type
    }
```

### 4. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
```python
# –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ calculate_total_orders_with_debug()
debug_info = {
    "nm_id": nm_id,
    "total_records_checked": len(orders_data),
    "matching_records": [],
    "filtered_out": [],
    "warehouse_breakdown": {},
    "warehouse_type_breakdown": {}
}
```

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –¢–µ—Å—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞:
```bash
python diagnose_article_issues.py --nm-id 163383326 --expected-total 98 --expected-warehouse "–ö–æ—Ç–æ–≤—Å–∫:18"
```

#### –¢–µ—Å—Ç —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π:
```bash
python diagnose_article_issues.py --nm-id [ARTICLE_ID] --log-level DEBUG
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–ª–∞–¥–æ–≤ –ú–ü:
```python
# –í Python-–∫–æ–¥–µ - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–∫–ª–∞–¥—ã —Å warehouseType="–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞" –≤–∫–ª—é—á–µ–Ω—ã
from stock_tracker.core.calculator import is_real_warehouse

result = is_real_warehouse("–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞ –ú–ü-1")  # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å True
```

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### 1. ‚úÖ –°–∫–ª–∞–¥—ã –ú–ü –≤–∫–ª—é—á–µ–Ω—ã
- –°–∫–ª–∞–¥—ã —Å `warehouseType="–°–∫–ª–∞–¥ –ø—Ä–æ–¥–∞–≤—Ü–∞"` —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ –ú–ü

### 2. ‚úÖ –°–∫–ª–∞–¥—ã —Å –Ω—É–ª–µ–≤—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- –°–∫–ª–∞–¥—ã —Å –∑–∞–∫–∞–∑–∞–º–∏ –Ω–æ –Ω—É–ª–µ–≤—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
- Stock=0, Orders>0 –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

### 3. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–¥—Å—á–µ—Ç–∞ –∑–∞–∫–∞–∑–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–∞–∫ –≤ WB –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—É–º–º

### 4. ‚úÖ –ì–æ—Ç–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ä—Ç–∏–∫—É–ª–∞ 163383326
- –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –æ–∂–∏–¥–∞–µ—Ç—Å—è 98 –∑–∞–∫–∞–∑–æ–≤ –≤—Å–µ–≥–æ, 18 –¥–ª—è –ö–æ—Ç–æ–≤—Å–∫–∞

## üîç –ö–õ–Æ–ß–ï–í–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### 1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–∫–ª–∞–¥–æ–≤
- **–î–æ**: –ò—Å–∫–ª—é—á–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å—ã –¥–æ—Å—Ç–∞–≤–∫–∏
- **–ü–æ—Å–ª–µ**: + –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∫–ª–∞–¥–æ–≤ –ú–ü + –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Å–∫–ª–∞–¥–æ–≤

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Å–∫–ª–∞–¥–æ–≤
- **–î–æ**: –¢–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
- **–ü–æ—Å–ª–µ**: + –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∑–∞–∫–∞–∑–æ–≤ (–¥–∞–∂–µ —Å –Ω—É–ª–µ–≤—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏)

### 3. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **–î–æ**: –ü—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Å—á–µ—Ç –∑–∞–∫–∞–∑–æ–≤
- **–ü–æ—Å–ª–µ**: + –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ + –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è + –æ—Ç—á–µ—Ç—ã

### 4. –¢–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–æ–≤
- **–î–æ**: –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —Å WB
- **–ü–æ—Å–ª–µ**: + –í–∞–ª–∏–¥–∞—Ü–∏—è + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞
```bash
# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏
python diagnose_article_issues.py --nm-id 163383326 --expected-total 98 --expected-warehouse "–ö–æ—Ç–æ–≤—Å–∫:18"
```

### 2. –û–±—â–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª—é–±–æ–≥–æ –∞—Ä—Ç–∏–∫—É–ª–∞
python diagnose_article_issues.py --nm-id [ARTICLE_ID] --log-level INFO
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤ –∫–æ–¥–µ
from stock_tracker.services.product_service import ProductService

service = ProductService()
result = await service.sync_product_with_verification(
    seller_article="ARTICLE_123",
    wildberries_article=163383326,
    expected_wb_data={"total_orders": 98, "warehouse_breakdown": {"–ö–æ—Ç–æ–≤—Å–∫": 18}}
)
```

## üìà –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –û–ë–°–õ–£–ñ–ò–í–ê–ù–ò–ï

### 1. –õ–æ–≥–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –í—Å–µ –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–æ–±–∞–≤–ª—è—é—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--log-level DEBUG` –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ú–µ—Ç–æ–¥ `validate_orders_calculation()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—É–º–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è—Ö

### 3. –û—Ç—á–µ—Ç—ã –æ —Ç–æ—á–Ω–æ—Å—Ç–∏
- `CalculationVerifier` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏ WB –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

‚úÖ **–í–°–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ò–ó –ü–†–û–ú–ü–¢–ê –†–ï–ê–õ–ò–ó–û–í–ê–ù–´**

1. **–°–∫–ª–∞–¥—ã –ø—Ä–æ–¥–∞–≤—Ü–∞ (–ú–ü)** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç—ã
2. **–°–∫–ª–∞–¥—ã —Å –Ω—É–ª–µ–≤—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏** - –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∑–∞–∫–∞–∑–æ–≤  
3. **–¢–æ—á–Ω–æ—Å—Ç—å –ø–æ–¥—Å—á–µ—Ç–∞ –∑–∞–∫–∞–∑–æ–≤** - —É–ª—É—á—à–µ–Ω–∞ —Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
4. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ 163383326** - –≥–æ—Ç–æ–≤–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å **—Ç–æ—á–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–æ–≥–∏–∫–µ WB –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞** –∏ **—É—Å—Ç—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è**.

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê**  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**: ‚úÖ **–ì–û–¢–û–í–û**  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ù–ê –†–ï–ê–õ–¨–ù–´–• –î–ê–ù–ù–´–•**