# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ª–∏—Å—Ç–∞ "–¢–æ–≤–∞—Ä—ã"

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –∫–æ–¥–µ –Ω–∞ "Stock Tracker", Google Sheets –ø—Ä–æ–¥–æ–ª–∂–∞–ª –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏—Å—Ç —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º "–¢–æ–≤–∞—Ä—ã".

## üîç –ü—Ä–∏—á–∏–Ω–∞
–§—É–Ω–∫—Ü–∏—è `get_or_create_worksheet()` —Å–Ω–∞—á–∞–ª–∞ **–∏—â–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ª–∏—Å—Ç** —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–º–µ–Ω–µ–º. –ï—Å–ª–∏ –ª–∏—Å—Ç "–¢–æ–≤–∞—Ä—ã" —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª –≤ Google Sheets, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∞ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –Ω–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "Stock Tracker".

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤ `get_or_create_worksheet()`

–î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ `src/stock_tracker/database/operations.py`:

```python
def get_or_create_worksheet(self, spreadsheet_id: str, 
                          worksheet_name: str = "Stock Tracker") -> gspread.Worksheet:
    try:
        # –ò—â–µ–º –ª–∏—Å—Ç —Å –Ω–æ–≤—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
        worksheet = spreadsheet.worksheet(worksheet_name)
        return worksheet
        
    except WorksheetNotFound:
        # –ï—Å–ª–∏ –∏—â–µ–º "Stock Tracker", –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ —Å—Ç–∞—Ä—ã–π "–¢–æ–≤–∞—Ä—ã"
        if worksheet_name == "Stock Tracker":
            try:
                legacy_worksheet = spreadsheet.worksheet("–¢–æ–≤–∞—Ä—ã")
                # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π –ª–∏—Å—Ç
                legacy_worksheet.update_title("Stock Tracker")
                return legacy_worksheet
            except WorksheetNotFound:
                pass
        
        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ª–∏—Å—Ç –µ—Å–ª–∏ —Å—Ç–∞—Ä–æ–≥–æ –Ω–µ—Ç
        worksheet = spreadsheet.add_worksheet(title=worksheet_name, ...)
        return worksheet
```

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `rename_worksheet_from_legacy()` –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```python
def rename_worksheet_from_legacy(self, spreadsheet_id: str, 
                               old_name: str = "–¢–æ–≤–∞—Ä—ã", 
                               new_name: str = "Stock Tracker") -> bool:
    # –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
```

## üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

–ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ Google Sheets —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å:

1. **–ò—â–µ—Ç –ª–∏—Å—Ç "Stock Tracker"** (–Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)
2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω ‚úÖ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ
3. –ï—Å–ª–∏ –ù–ï –Ω–∞–π–¥–µ–Ω ‚ùå - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –ª–∏—Å—Ç–∞ "–¢–æ–≤–∞—Ä—ã"
4. –ï—Å–ª–∏ —Å—Ç–∞—Ä—ã–π –ª–∏—Å—Ç –Ω–∞–π–¥–µ–Ω üîÑ - **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç** –≤ "Stock Tracker"
5. –ï—Å–ª–∏ —Å—Ç–∞—Ä–æ–≥–æ –ª–∏—Å—Ç–∞ —Ç–æ–∂–µ –Ω–µ—Ç ‚ûï - **—Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π** –ª–∏—Å—Ç "Stock Tracker"

## üìã –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –§–∞–π–ª—ã —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
- ‚úÖ `src/stock_tracker/database/operations.py` - 17 —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ `fix_table_structure.py`
- ‚úÖ `simple_table_analyzer.py`
- ‚úÖ `fix_misplaced_data.py`
- ‚úÖ `fix_g3_orders.py`
- ‚úÖ `clean_warehouse_data.py`
- ‚úÖ `apply_improved_logic.py`
- ‚úÖ `analyze_table_data.py`
- ‚úÖ `quick_fix_warehouse_data.py`

### –ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤ `get_or_create_worksheet()`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `rename_worksheet_from_legacy()` –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: –Ω–∞–π–¥–µ–Ω
- ‚úÖ –ü–æ–∏—Å–∫ —Å—Ç–∞—Ä–æ–≥–æ –ª–∏—Å—Ç–∞: –Ω–∞–π–¥–µ–Ω  
- ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ: –Ω–∞–π–¥–µ–Ω
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –Ω–∞–π–¥–µ–Ω

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!** –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ Google Sheets:

- –ï—Å–ª–∏ –ª–∏—Å—Ç "–¢–æ–≤–∞—Ä—ã" —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ "Stock Tracker"
- –ï—Å–ª–∏ –ª–∏—Å—Ç–∞ "–¢–æ–≤–∞—Ä—ã" –Ω–µ—Ç ‚Üí –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ª–∏—Å—Ç "Stock Tracker"
- –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª–∏—Å—Ç–æ–º "Stock Tracker"

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –ª—é–±–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å Google Sheets.

---
*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: 22 –æ–∫—Ç—è–±—Ä—è 2025 –≥.*